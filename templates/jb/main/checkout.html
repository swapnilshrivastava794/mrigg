{% extends 'base.html' %}
{% load static %}
{% block body %}

<!-- Checkout Section -->
<section class="checkout-section">
  <div class="container">
    <div class="checkout-header">
      <h1 class="checkout-title">Checkout</h1>
      <p class="checkout-subtitle">Complete your order details</p>
    </div>

    <div class="checkout-content">
      <div class="checkout-form-section">
        <div class="form-card">
          <div class="form-header">
            <h3 class="form-title">
              <i class="fa fa-user"></i>
              Shipping Information
            </h3>
          </div>
          
          <form method="post" class="checkout-form">
            {% csrf_token %}
            
            <div class="form-row">
              <div class="form-group">
                <label for="first_name" class="form-label">First Name</label>
                <input type="text" id="first_name" name="first_name" class="form-input" required value="{{ user.first_name }}">
              </div>
              <div class="form-group">
                <label for="last_name" class="form-label">Last Name</label>
                <input type="text" id="last_name" name="last_name" class="form-input" required value="{{ user.last_name }}">
              </div>
            </div>

            <div class="form-group">
              <label for="email" class="form-label">Email Address</label>
              <input type="email" id="email" name="email" class="form-input" required value="{{ user.email }}">
            </div>

            <div class="form-group">
              <label for="address" class="form-label">Address</label>
              <textarea id="address" name="address" class="form-textarea" required placeholder="Enter your complete address">{{ user.address_line1 }} {{ user.address_line2 }}</textarea>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="city" class="form-label">City</label>
                <input type="text" id="city" name="city" class="form-input" required value="{{ user.city }}">
              </div>
              <div class="form-group">
                <label for="postal_code" class="form-label">Postal Code</label>
                <input type="text" id="postal_code" name="postal_code" class="form-input" required value="{{ user.zip_code }}">
              </div>
            </div>

            <div class="form-actions">
              <button type="submit" class="place-order-btn">
                <i class="fa fa-credit-card"></i>
                Place Order
              </button>
            </div>
          </form>
        </div>

        <div class="order-history-link">
          <a href="{% url 'order_history' %}" class="history-btn">
            <i class="fa fa-history"></i>
            View Your Order History
          </a>
        </div>
      </div>

      <div class="checkout-summary">
        <div class="summary-card">
          <div class="summary-header">
            <h3 class="summary-title">
              <i class="fa fa-shopping-cart"></i>
              Order Summary
            </h3>
          </div>

          <div class="order-items">
            {% for item in cart_items %}
              <div class="order-item">
                <div class="order-item-image">
                  {% if item.product.images.all|length > 0 %}
                    <img src="{{ item.product.images.all.0.image.url }}" alt="{{ item.product.name }}">
                  {% else %}
                    <img src="{% static 'img/default-placeholder.png' %}" alt="No image">
                  {% endif %}
                </div>
                <div class="order-item-details">
                  <h4 class="order-item-name">{{ item.product.name }}</h4>
                  <div class="order-item-category">{{ item.product.category.name }}</div>
                  <div class="order-item-quantity">Qty: {{ item.quantity }}</div>
                </div>
                <div class="order-item-price">₹{{ item.subtotal }}</div>
              </div>
            {% endfor %}
          </div>

          <div class="order-summary">
            <div class="summary-row">
              <span class="summary-label">Subtotal</span>
              <span class="summary-value">₹{{ total_price }}</span>
            </div>
            
            <div class="summary-row">
              <span class="summary-label">Shipping</span>
              <span class="summary-value">Free</span>
            </div>
            
            <div class="summary-row">
              <span class="summary-label">Tax</span>
              <span class="summary-value">₹0.00</span>
            </div>
            
            <div class="summary-divider"></div>
            
            <div class="summary-row total-row">
              <span class="summary-label">Total</span>
              <span class="summary-value">₹{{ total_price }}</span>
            </div>
          </div>

          <div class="payment-info">
            <div class="payment-method">
              <i class="fa fa-credit-card"></i>
              <span>Payment will be processed securely</span>
            </div>
            <div class="security-badges">
              <div class="security-badge">
                <i class="fa fa-shield"></i>
                <span>Secure</span>
              </div>
              <div class="security-badge">
                <i class="fa fa-lock"></i>
                <span>Encrypted</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

{% endblock %}
